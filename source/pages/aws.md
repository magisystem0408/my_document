# aws
## ELB
直接webサーバーにアクセスすると単一障害点となる

### ロードバランサーにはDNS名のアクセスポイントが付与される
### ヘルスチェック機能がある
異常なインスタンスを認識し、通信をストップする

### ELBに証明書を付与
SSLの終端をSSLターミネーション

### ELBの種類
- ALB
L7ロードバランサー、http,httpsの負荷分散で使用する
- NLB
L4ロードバランサー、TCP,UDPの負荷分散で使用する
- CLB
以前までのロードバランサー

### 構成の仕方
ELBをパブリックサブネットに配置して、他EC2インスタンスとか
プライベートサブネットに配置する構成が多い

### 使用の仕方
1.LBはリスナーを複数持てる(HTTP/HTTPSなど)
2.リスナーはルールを複数持てる
- リスナーがこれだったらこのアクションをするなどリスナールールを決める
  - 以下を優先順位をつけて管理できる(ルール)
    - host-header
    - http-header
    - http-request-method
    - path-pattern
    - query-string
    - source-ip
    - デフォルト
  - アクション
    - 転送(ターゲットグループに転送が使われる)
    - リダイレクト
    - 固定レスポンス
    - OIDC認証
    - Cognito認証
3.リスナーのルールは通常デフォルトアクションとして通信をターゲットグループに転送する
4.ターゲットグループは複数のターゲットグループをもつ
5.ターゲットはEC2インスタンス、Lambda、IPアドレスを指定できる